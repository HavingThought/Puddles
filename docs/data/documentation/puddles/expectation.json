{"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Expectation"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"ExpectedType"},{"kind":"text","text":">"}],"languages":["swift"],"platforms":["iOS"]}]},{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Sometimes an action triggers a flow that requires user input or some form of other delayed and disconnected data to complete."},{"type":"text","text":" "},{"type":"text","text":"An example of this would be a confirmation dialog for a deletion process."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Such a dialog would typically be triggered from within a "},{"type":"codeVoice","code":"Coordinator"},{"type":"text","text":"‘s "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/handleAction(_:)-38d52"},{"type":"text","text":" method and finished within the dialog’s completion handlers. This logically separates the deletion flow and makes it harder to reason about the code."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"By using an "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation"},{"type":"text","text":", you can simply "},{"type":"codeVoice","code":"await"},{"type":"text","text":" the results of the dialog from right within "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/handleAction(_:)-38d52"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To do this, wrap a navigation presentation (like a confirmation dialog) in an instance of "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expecting"},{"type":"text","text":", passing in a binding to an "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation"},{"type":"text","text":" instance."},{"type":"text","text":" "},{"type":"text","text":"The "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expecting"},{"type":"text","text":" wrapper will provide an "},{"type":"codeVoice","code":"isActive"},{"type":"text","text":" binding that you can pass to your presentation."},{"type":"text","text":" "},{"type":"text","text":"Then, inside the "},{"type":"codeVoice","code":"Coordinator"},{"type":"text","text":"’s "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/handleAction(_:)-4le7d"},{"type":"text","text":" method,"},{"type":"text","text":" "},{"type":"text","text":"you can start the presentation by calling "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/show()"},{"type":"text","text":" on the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation"},{"type":"text","text":"."},{"type":"text","text":" "},{"type":"text","text":"Having done this, you can simply "},{"type":"codeVoice","code":"await"},{"type":"text","text":" the results of the presentation through the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/result"},{"type":"text","text":" property."},{"type":"text","text":" "},{"type":"text","text":"Lastly, to finish the presentation, call "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/hide()"},{"type":"text","text":"."}]},{"style":"important","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"By "},{"type":"codeVoice","code":"await"},{"type":"text","text":"ing a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/result"},{"type":"text","text":", you have to guarantee that the expectation will be completed exactly once, no less and no more! Failing to do so will cause undefined behavior and even crashes, since this view makes use of "},{"type":"codeVoice","code":"CheckedContinuation"},{"type":"text","text":"s."}]}],"type":"aside","name":"Important"},{"anchor":"Example","level":2,"type":"heading","text":"Example"},{"type":"codeListing","syntax":"swift","code":["struct HomeCoordinator: Coordinator {","  @StateObject var interface: MyView.Interface = .init()","  ","  @State var deletionConfirmation = Expectation<Bool>.guaranteedCompletion()","  ","  var entryView: some View {","    MyView(interface: interface)","  }","","  func navigation() -> some NavigationPattern {","    Expecting($deletionConfirmation) { isActive, expectation in","      Alert(","        title: \"Do you want to delete this?\",","        isPresented: isActive) {","          Button(\"Cancel\", role: .cancel) {","            expectation.complete(with: false)","          }","          Button(\"OK\") {","            expectation.complete(with: true)","          }","        } message: {","          Text(\"This cannot be reversed!\")","        }","    }","  }","","  func handleAction(_ action: Action) async {","    switch action {","    case .deleteButtonTapped:","      deletionConfirmation.show()","      let shouldDelete = await deletionConfirmation.result","      if shouldDelete {","        \/\/ Delete","      }","      \/\/ Alerts automatically hide, so no need to do it here","    }","  }","}"]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/puddles\/expectation"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"A type that can be used to trigger the collection of some kind of disconnected, delayed data (like a "},{"type":"codeVoice","code":"Bool"},{"type":"text","text":" coming from a confirmation dialog view) and asynchronously "},{"type":"codeVoice","code":"await"},{"type":"text","text":" its retrieval in-place, without ever leaving the original scope."}],"kind":"symbol","metadata":{"fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Expectation"}],"title":"Expectation","roleHeading":"Structure","role":"symbol","symbolKind":"struct","externalID":"s:7Puddles11ExpectationV","modules":[{"name":"Puddles"}],"navigatorTitle":[{"kind":"identifier","text":"Expectation"}]},"hierarchy":{"paths":[["doc:\/\/Puddles\/documentation\/Puddles"]]},"topicSections":[{"title":"Related Types","identifiers":["doc:\/\/Puddles\/documentation\/Puddles\/Expecting"]},{"title":"Structures","identifiers":["doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/Resolver"]},{"title":"Instance Properties","identifiers":["doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/result"]},{"title":"Instance Methods","identifiers":["doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/complete(with:)","doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/hide()","doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/show()"]},{"title":"Type Methods","identifiers":["doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/guaranteedCompletion()","doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/userCancellable(resultOnUserCancel:)"]}],"references":{"doc://Puddles/documentation/Puddles/Expectation/result":{"role":"symbol","title":"result","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"result"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ExpectedType","preciseIdentifier":"s:7Puddles11ExpectationV12ExpectedTypexmfp"}],"abstract":[{"type":"text","text":"The result of the expectation."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/result","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/expectation\/result"},"doc://Puddles/documentation/Puddles/Coordinator/handleAction(_:)-4le7d":{"conformance":{"constraints":[{"type":"codeVoice","code":"Interface.Action"},{"type":"text","text":" is "},{"type":"codeVoice","code":"NoAction"},{"type":"text","text":"."}],"availabilityPrefix":[{"type":"text","text":"Available when"}],"conformancePrefix":[{"type":"text","text":"Conforms when"}]},"role":"symbol","title":"handleAction(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"handleAction"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"Action","preciseIdentifier":"s:7Puddles11CoordinatorP6Actiona"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"}],"abstract":[{"type":"text","text":"A method you can provide to handle incoming actions from the  "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator"},{"type":"text","text":"’s "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/interface-swift.property-4rvqq"},{"type":"text","text":"."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/handleAction(_:)-4le7d","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/coordinator\/handleaction(_:)-4le7d"},"doc://Puddles/documentation/Puddles/Expectation/hide()":{"role":"symbol","title":"hide()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"hide"},{"kind":"text","text":"()"}],"abstract":[{"type":"text","text":"Stops the expectation by setting its "},{"type":"codeVoice","code":"isActive"},{"type":"text","text":" to "},{"type":"codeVoice","code":"false"},{"type":"text","text":"."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/hide()","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/expectation\/hide()"},"doc://Puddles/documentation/Puddles/Expectation/Resolver":{"role":"symbol","title":"Expectation.Resolver","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Resolver"}],"abstract":[{"type":"text","text":"Helper type to hide other implementation details of "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation"},{"type":"text","text":"."},{"type":"text","text":" "},{"type":"text","text":"This type only exposes a single method to complete the expectation."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/Resolver","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Resolver"}],"url":"\/documentation\/puddles\/expectation\/resolver"},"doc://Puddles/documentation/Puddles/Expectation/complete(with:)":{"role":"symbol","title":"complete(with:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"complete"},{"kind":"text","text":"("},{"kind":"externalParam","text":"with"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ExpectedType","preciseIdentifier":"s:7Puddles11ExpectationV12ExpectedTypexmfp"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Completes the expectation with a result."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/complete(with:)","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/expectation\/complete(with:)"},"doc://Puddles/documentation/Puddles/Expectation/userCancellable(resultOnUserCancel:)":{"role":"symbol","title":"userCancellable(resultOnUserCancel:)","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"userCancellable"},{"kind":"text","text":"("},{"kind":"externalParam","text":"resultOnUserCancel"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ExpectedType","preciseIdentifier":"s:7Puddles11ExpectationV12ExpectedTypexmfp"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"Expectation","preciseIdentifier":"s:7Puddles11ExpectationV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"ExpectedType","preciseIdentifier":"s:7Puddles11ExpectationV12ExpectedTypexmfp"},{"kind":"text","text":">"}],"abstract":[{"type":"text","text":"Initializes an expectation that could be interrupted by user interaction."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/userCancellable(resultOnUserCancel:)","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/expectation\/usercancellable(resultonusercancel:)"},"doc://Puddles/documentation/Puddles/Expectation/guaranteedCompletion()":{"role":"symbol","title":"guaranteedCompletion()","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"guaranteedCompletion"},{"kind":"text","text":"() -> "},{"kind":"typeIdentifier","text":"Expectation","preciseIdentifier":"s:7Puddles11ExpectationV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"ExpectedType","preciseIdentifier":"s:7Puddles11ExpectationV12ExpectedTypexmfp"},{"kind":"text","text":">"}],"abstract":[{"type":"text","text":"Initializes an expectation that is guaranteed not to be interrupted and cancelled by user interaction."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/guaranteedCompletion()","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/expectation\/guaranteedcompletion()"},"doc://Puddles/documentation/Puddles/Expectation":{"role":"symbol","title":"Expectation","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Expectation"}],"abstract":[{"type":"text","text":"A type that can be used to trigger the collection of some kind of disconnected, delayed data (like a "},{"type":"codeVoice","code":"Bool"},{"type":"text","text":" coming from a confirmation dialog view) and asynchronously "},{"type":"codeVoice","code":"await"},{"type":"text","text":" its retrieval in-place, without ever leaving the original scope."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Expectation"}],"url":"\/documentation\/puddles\/expectation"},"doc://Puddles/documentation/Puddles/Coordinator/interface-swift.property-4rvqq":{"defaultImplementations":1,"role":"symbol","title":"interface","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"interface"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Interface","preciseIdentifier":"s:7Puddles11CoordinatorP9InterfaceQa"}],"abstract":[{"type":"text","text":"An interface, usually connected to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator"},{"type":"text","text":"s "},{"type":"codeVoice","code":"entryView"},{"type":"text","text":"."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/interface-swift.property-4rvqq","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/puddles\/coordinator\/interface-swift.property-4rvqq"},"doc://Puddles/documentation/Puddles/Coordinator/handleAction(_:)-38d52":{"defaultImplementations":1,"role":"symbol","title":"handleAction(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"handleAction"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"Action","preciseIdentifier":"s:7Puddles11CoordinatorP6Actiona"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"}],"abstract":[{"type":"text","text":"A method you can provide to handle incoming actions from the  "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator"},{"type":"text","text":"’s "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/interface-swift.property-4rvqq"},{"type":"text","text":"."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator\/handleAction(_:)-38d52","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/puddles\/coordinator\/handleaction(_:)-38d52"},"doc://Puddles/documentation/Puddles/Expecting":{"role":"symbol","title":"Expecting","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Expecting"}],"abstract":[{"type":"text","text":"A navigation wrapper using an "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation"},{"type":"text","text":" to retrieve delayed asynchronous data from a contained presentation. See "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation"},{"type":"text","text":" for more information."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expecting","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Expecting"}],"url":"\/documentation\/puddles\/expecting"},"doc://Puddles/documentation/Puddles/Coordinator":{"role":"symbol","title":"Coordinator","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"Coordinator"}],"abstract":[{"type":"text","text":"A type that coordinates the navigation and data management of a "},{"type":"codeVoice","code":"View"},{"type":"text","text":"."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Coordinator","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Coordinator"}],"url":"\/documentation\/puddles\/coordinator"},"doc://Puddles/documentation/Puddles/Expectation/show()":{"role":"symbol","title":"show()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"show"},{"kind":"text","text":"()"}],"abstract":[{"type":"text","text":"Start the expectation by setting its "},{"type":"codeVoice","code":"isActive"},{"type":"text","text":" to "},{"type":"codeVoice","code":"true"},{"type":"text","text":"."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles\/Expectation\/show()","kind":"symbol","type":"topic","url":"\/documentation\/puddles\/expectation\/show()"},"doc://Puddles/documentation/Puddles":{"role":"collection","title":"Puddles","abstract":[{"type":"text","text":"An architectural pattern for apps built on the SwiftUI lifecycle. It helps separating navigation and logic from the views."}],"identifier":"doc:\/\/Puddles\/documentation\/Puddles","kind":"symbol","type":"topic","url":"\/documentation\/puddles"}}}